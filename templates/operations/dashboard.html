{% extends 'base.html' %}

{% block title %}Operations Dashboard{% endblock %}
{% block page_title %}Operations Dashboard{% endblock %}

{% block content %}
<!-- Stats -->
<div class="stats-grid">
    <div class="stat-card indigo fade-up stagger-1">
        <div class="stat-icon">ğŸ“‹</div>
        <div class="stat-value">{{ total_complaints }}</div>
        <div class="stat-label">Total Complaints</div>
    </div>
    <div class="stat-card amber fade-up stagger-2">
        <div class="stat-icon">â³</div>
        <div class="stat-value">{{ pending_complaints }}</div>
        <div class="stat-label">Pending</div>
    </div>
    <div class="stat-card emerald fade-up stagger-3">
        <div class="stat-icon">âœ…</div>
        <div class="stat-value">{{ resolved_today }}</div>
        <div class="stat-label">Resolved Today</div>
    </div>
    <div class="stat-card cyan fade-up stagger-4">
        <div class="stat-icon">ğŸ‘·</div>
        <div class="stat-value">{{ active_engineers }}</div>
        <div class="stat-label">Active Engineers</div>
    </div>
    <div class="stat-card violet fade-up stagger-5">
        <div class="stat-icon">ğŸ”§</div>
        <div class="stat-value">{{ total_parts }}</div>
        <div class="stat-label">Total Parts</div>
    </div>
    <div class="stat-card rose fade-up stagger-6">
        <div class="stat-icon">ğŸš¨</div>
        <div class="stat-value">{{ low_stock_parts }}</div>
        <div class="stat-label">Low Stock</div>
    </div>
</div>

<!-- Quick Actions -->
<div class="section-header">
    <h3 class="section-title">Quick Actions</h3>
</div>
<div class="quick-actions fade-up">
    <a href="{% url 'create_complaint' %}" class="quick-action-card">
        <span class="qa-icon">ğŸ“‹</span>New Complaint
    </a>
    <a href="{% url 'user_management' %}" class="quick-action-card">
        <span class="qa-icon">ğŸ‘¤</span>Add User
    </a>
    <a href="{% url 'client_management' %}" class="quick-action-card">
        <span class="qa-icon">ğŸ¢</span>Add Client
    </a>
    <a href="{% url 'product_management' %}" class="quick-action-card">
        <span class="qa-icon">ğŸ“¦</span>Add Product
    </a>
    <a href="{% url 'fault_management' %}" class="quick-action-card">
        <span class="qa-icon">âš¡</span>Add Fault
    </a>
    <a href="{% url 'part_management' %}" class="quick-action-card">
        <span class="qa-icon">ğŸ”§</span>Add Part
    </a>
    <a href="{% url 'inventory_alerts' %}" class="quick-action-card">
        <span class="qa-icon">ğŸš¨</span>Stock Alerts
    </a>
</div>

<!-- Recent Complaints & Low Stock -->
<div class="charts-grid">
    <div class="glass-card fade-up">
        <div class="card-header">
            <h3>Recent Complaints</h3>
            <a href="{% url 'pending_complaints' %}" class="btn btn-secondary btn-sm">View Pending â†’</a>
        </div>
        {% if recent_complaints %}
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Complaint #</th>
                        <th>Client</th>
                        <th>Status</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for c in recent_complaints %}
                    <tr>
                        <td class="td-bold">{{ c.complaint_no }}</td>
                        <td>{{ c.client }}</td>
                        <td><span class="badge badge-{{ c.status }}">{{ c.get_status_display }}</span></td>
                        <td>{{ c.created_at|date:"d M" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>No complaints yet</p>
        </div>
        {% endif %}
    </div>

    <div class="glass-card fade-up">
        <div class="card-header">
            <h3>Low Stock Alerts</h3>
            <a href="{% url 'inventory_alerts' %}" class="btn btn-danger btn-sm">View All â†’</a>
        </div>
        {% if low_stock_items %}
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Part</th>
                        <th>Make</th>
                        <th>Stock</th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in low_stock_items %}
                    <tr>
                        <td class="td-bold">{{ p.name }}</td>
                        <td>{{ p.make }}</td>
                        <td>
                            <span class="{% if p.stock_quantity == 0 %}stock-out{% else %}stock-low{% endif %}">
                                {{ p.stock_quantity }} {% if p.stock_quantity == 0 %}(Out!){% endif %}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>All stock levels are healthy ğŸ‰</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}